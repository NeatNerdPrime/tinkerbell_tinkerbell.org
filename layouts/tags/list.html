{{ define "main" }}
  {{ partial "navbar" . }}
  <div class="blog-container">
    <header class="blog-header">
      <h1>Posts tagged "{{ .Title }}"</h1>
      <p class="blog-description">{{ len .Pages }} post{{ if ne (len .Pages) 1 }}s{{ end }} with this tag</p>
    </header>

    {{ $posts := .Pages.ByDate.Reverse }}

    {{ if gt (len $posts) 0 }}
    <div class="blog-grid">
      {{ range $posts }}
      {{ $post := . }}
      <article class="blog-card">
        {{ with .Params.image }}
        <div class="blog-card__image">
          <a href="{{ $post.RelPermalink }}">
            <img src="{{ . }}" alt="{{ $post.Title }}" loading="lazy">
          </a>
        </div>
        {{ end }}
        <div class="blog-card__content">
          <div class="blog-meta">
            {{ with .Params.author }}
            <span class="blog-author">
              {{ if $post.Params.authorGithub }}
              <a href="https://github.com/{{ $post.Params.authorGithub }}" target="_blank" rel="noopener">{{ . }}</a>
              {{ else }}
              {{ . }}
              {{ end }}
            </span>
            <span class="blog-meta__sep">·</span>
            {{ end }}
            <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
          </div>
          <h3 class="blog-card__title">
            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
          </h3>
          {{ with .Description }}<p class="blog-card__excerpt">{{ . }}</p>{{ end }}
          {{ with .Params.tags }}
          <div class="blog-tags">
            {{ range first 3 . }}
            <a href="{{ "tags/" | relURL }}{{ . | urlize }}/" class="blog-tag">{{ . }}</a>
            {{ end }}
          </div>
          {{ end }}
        </div>
      </article>
      {{ end }}
    </div>
    {{ else }}
    <div class="blog-empty">
      <p>No posts with this tag yet.</p>
    </div>
    {{ end }}

    <div class="blog-post__back" style="margin-top: 2rem;">
      <a href="{{ "blog/" | relURL }}">← Back to all posts</a>
    </div>
  </div>
{{ end }}
